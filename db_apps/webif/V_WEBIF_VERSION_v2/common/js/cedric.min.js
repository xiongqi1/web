function Cedric(m){var v,y,f=!1,e=0,g=0,w=0,C=0,p=0,q=0,k=0,z=500,A=15,x=0,l=!0,d=0,r=0,t=this,b,n,u=0,B=0;this.setProgressStyle=function(a,b,c){document.getElementById(a).style[b]=c};this.setProgressWidth=function(a){a>=u?(this.setProgressStyle("upload_status","width",a+"px"),u=a):u-a>.5*m&&(B=u=0)};this.setProgressInfo=function(a,b){document.getElementById(a).innerHTML=b};this.showProgressDiv=function(a,b){this.setProgressStyle("progress_info","display",a?"":"none");this.setProgressStyle("progress_bar",
"display",b?"":"none")};this.zeroProgressBar=function(){y="";f=!1;q=p=w=g=e=0;l=!0;u=d=0;n="";this.setProgressWidth(0);this.setProgressInfo("percent","0%");this.setProgressInfo("current",0);this.setProgressInfo("total_kbytes",0);this.setProgressInfo("time",0);this.setProgressInfo("speed",0);this.setProgressInfo("remain",0)};this.smoothCedricStatus=function(){p<m&&!l&&(p++,this.setProgressWidth(p));f&&setTimeout(function(){t.smoothCedricStatus()},z)};this.smoothCedricBytes=function(){q<r&&!l&&(q++,
this.setProgressInfo("current",q));f&&setTimeout(function(){t.smoothCedricBytes()},A)};this.setProgressStatus=function(a,b){var c=0,h=0;0<b&&(c=a/b);0<c&&(h=Math.round((d-a)/c));1==x&&(0!==c?(z=Math.round(1E3*d/(c*m)),A=Math.round(1024E3/c)):(z=200,A=15));a>d&&(a=d);var f=a/d,k=Math.round(100*f),f=Math.round(f*m),e=h%60,g=(h-e)%3600/60,h=(h-e-60*g)%86400/3600;10>e&&(e="0"+e);10>g&&(g="0"+g);10>h&&(h="0"+h);h=h+":"+g+":"+e;c=Math.round(c/1024);a=Math.round(a/1024);a<B?a=B:pre_bytes_read=a;1==x?(l=
!1,p=f,q=a):(this.setProgressWidth(f),this.setProgressInfo("current",a));this.setProgressInfo("percent",isNaN(k)?0:k+" %");this.setProgressInfo("remain",h);this.setProgressInfo("speed",isNaN(c)?0:c)};this.getElapsedTime=function(){e++;60==e&&(e=0,g++);60==g&&(g=0,w++);this.setProgressInfo("time",""+(10>w?"0":"")+w+":"+(""+(10>g?"0":"")+g)+":"+(""+(10>e?"0":"")+e));f&&setTimeout(function(){t.getElapsedTime()},1E3)};this.runRabbit=function(a){v=500;x=1;k=0;f=!0;this.zeroProgressBar();this.startProgressStatus(a)};
this.stopUpload=function(){f=!1;try{window.stop()}catch(a){try{document.execCommand("Stop")}catch(b){}}};this.createRequestObject=function(){if(b)return b;if(window.XMLHttpRequest)b=new XMLHttpRequest;else if(window.ActiveXObject)try{b=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{b=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){}}if(b)return b;this.setProgressInfo("phase","Error: Your browser does not support AJAX");return!1};this.placeRequest=function(){b&&(b.open("GET",y+"&rnd_id="+Math.random(),
!0),b.onreadystatechange=function(){t.reqResponse()},b.send(null))};this.reqResponse=function(){if(4==b.readyState){if(200==b.status)if(0<b.responseText.length){var a=eval("("+b.responseText+")"),e=(new Date).getTime()-C,c="";a.colour&&this.setProgressStyle("upload_status","backgroundColor",a.colour);a.errors&&this.setProgressInfo("errors",a.errors.join("<br />"));a.messages&&this.setProgressInfo("messages",a.messages.join("<br />"));if(a.action)switch(a.action){case "start":case "continue":l=!1;
this.showProgressDiv(1,1);break;case "stop":l=!0,this.stopUpload()}d||(d=a.total_bytes,v=a.get_data_speed?a.get_data_speed:500,f=!0,c="Upload In Progress",r=Math.round(d/1024),this.setProgressInfo("total_kbytes",""+r),this.getElapsedTime(),x&&(this.smoothCedricBytes(),this.smoothCedricStatus()));a.title&&(c=a.title);c&&c!==n&&(n=c,this.setProgressInfo("phase",n));d||this.setProgressInfo("phase","Waiting for progress feedback");if("Finished"==c){k=d;this.setProgressWidth(m);this.setProgressInfo("percent",
"100%");this.setProgressInfo("current",r);window.location.reload();return}k=parseInt(a.last_bytes_read);0<a.total_bytes&&0<d&&(k>=d&&(k=d,this.setProgressWidth(m),this.setProgressInfo("current",r),l=!0),0<k&&this.setProgressStatus(k,e/1E3))}else b=null,this.createRequestObject();else b=null,this.createRequestObject();f&&v&&setTimeout(function(){t.placeRequest()},v)}};this.startProgressStatus=this.startNetProgressStatus=function(a){C=(new Date).getTime();this.createRequestObject();this.showProgressDiv(1,
1);d=0;y=a;b&&(n="Initializing Progress Bar",this.setProgressInfo("phase",n),this.placeRequest())}};
